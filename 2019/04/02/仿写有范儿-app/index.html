<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="旧文章迁移自：简书 create by 2016.11.15 22:53  项目下载地址 为什么仿写 app在 iOS 开发中有着大量的技术实现，架构方式。而在我们实际的工作中，因为业务或者设计的需要，很难有机会触及到这些内容。这个时候，我们就可以通过仿写别人 app 的方式，去实践一些自己的想法和在工作中很难接触到的技术。比如：当你在仿写相机类 app 的时候，可能会接触到很多滤镜方面的技术。当">
<meta name="keywords" content="Java, iOS, Web">
<meta property="og:type" content="article">
<meta property="og:title" content="仿写有范儿 app">
<meta property="og:url" content="https://github.com/al-liu/2019/04/02/仿写有范儿-app/index.html">
<meta property="og:site_name" content="刘海川的技术博客">
<meta property="og:description" content="旧文章迁移自：简书 create by 2016.11.15 22:53  项目下载地址 为什么仿写 app在 iOS 开发中有着大量的技术实现，架构方式。而在我们实际的工作中，因为业务或者设计的需要，很难有机会触及到这些内容。这个时候，我们就可以通过仿写别人 app 的方式，去实践一些自己的想法和在工作中很难接触到的技术。比如：当你在仿写相机类 app 的时候，可能会接触到很多滤镜方面的技术。当">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/292794-55268dd83b552366.gif?imageMogr2/auto-orient/strip">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/292794-6639a17836b0b5e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-04-02T12:29:59.758Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="仿写有范儿 app">
<meta name="twitter:description" content="旧文章迁移自：简书 create by 2016.11.15 22:53  项目下载地址 为什么仿写 app在 iOS 开发中有着大量的技术实现，架构方式。而在我们实际的工作中，因为业务或者设计的需要，很难有机会触及到这些内容。这个时候，我们就可以通过仿写别人 app 的方式，去实践一些自己的想法和在工作中很难接触到的技术。比如：当你在仿写相机类 app 的时候，可能会接触到很多滤镜方面的技术。当">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/292794-55268dd83b552366.gif?imageMogr2/auto-orient/strip">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>仿写有范儿 app</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="https://github.com/al-liu">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://github.com/al-liu?tab=repositories">项目</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/04/04/阅读源代码：SDWebImage-3-8-2/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/03/31/NSOperation-和-NSOperationQueue-的-Swift-教程/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://github.com/al-liu/2019/04/02/仿写有范儿-app/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&text=仿写有范儿 app"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&is_video=false&description=仿写有范儿 app"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=仿写有范儿 app&body=Check out this article: https://github.com/al-liu/2019/04/02/仿写有范儿-app/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&name=仿写有范儿 app&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么仿写-app"><span class="toc-number">1.</span> <span class="toc-text">为什么仿写 app</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么是有范儿"><span class="toc-number">2.</span> <span class="toc-text">为什么是有范儿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仿写目的"><span class="toc-number">3.</span> <span class="toc-text">仿写目的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#View"><span class="toc-number">3.1.</span> <span class="toc-text">View</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ViewModel"><span class="toc-number">3.2.</span> <span class="toc-text">ViewModel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Service，IMP-和-Model"><span class="toc-number">3.3.</span> <span class="toc-text">Service，IMP 和 Model</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仿写流程-和-注意事项"><span class="toc-number">4.</span> <span class="toc-text">仿写流程 和 注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">5.</span> <span class="toc-text">最后</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        仿写有范儿 app
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">刘海川的技术博客</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-04-02T12:28:42.000Z" itemprop="datePublished">2019-04-02</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>旧文章迁移自：<a href="https://www.jianshu.com/u/06062b2fb381" target="_blank" rel="noopener">简书</a> create by 2016.11.15 22:53</p>
<p><img src="http://upload-images.jianshu.io/upload_images/292794-55268dd83b552366.gif?imageMogr2/auto-orient/strip" alt="效果图"></p>
<p><a href="https://github.com/al-liu/HCFunwear-iOS">项目下载地址</a></p>
<h2 id="为什么仿写-app"><a href="#为什么仿写-app" class="headerlink" title="为什么仿写 app"></a>为什么仿写 app</h2><p>在 iOS 开发中有着大量的技术实现，架构方式。而在我们实际的工作中，因为业务或者设计的需要，很难有机会触及到这些内容。这个时候，我们就可以通过仿写别人 app 的方式，去实践一些自己的想法和在工作中很难接触到的技术。<br>比如：当你在仿写相机类 app 的时候，可能会接触到很多滤镜方面的技术。当在仿写阅读类 app 的时候，就会涉及 CoreText 排版方面的技术。而我仿写有范儿主要是想实践一下 <strong>MVVM</strong> 和 <strong>ReactiveCocoa</strong> 结合起来的一种架构方式。<br>对于刚接触 iOS 或者其他技术的人，想要学的更多，最好的方法就是实践，如果在工作中没有更多的实践机会，最好的方法就是仿写，造轮子。在项目中会涉及到很多在看资料中涉及不到的细节问题，想办法解决它们，这对于提高解决问题的能力上很有帮助。</p>
<h2 id="为什么是有范儿"><a href="#为什么是有范儿" class="headerlink" title="为什么是有范儿"></a>为什么是有范儿</h2><p>在我看过的众多电商应用里，非常喜欢有范儿 app 的设计，再打开应用之后界面给人一种清新简洁的感觉，总之，就是很有 b 格。对于我来说，能去实现下自己喜欢的设计的 app，会让人感到愉悦。</p>
<h2 id="仿写目的"><a href="#仿写目的" class="headerlink" title="仿写目的"></a>仿写目的</h2><p>仿写的目的是为了实践一些东西，我的目的就是想实践一下 <strong>MVVM</strong> 和 <strong>ReactiveCocoa</strong> 的架构方式。<br>简单介绍下我是怎么用的。(个人理解可能有误，欢迎拍砖。)</p>
<h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><p>View 层面包括，View 和 ViewController。当要实现一个界面的时候，先简单分析下界面的构成，然后对它进行拆分。看下整体是使用 <code>UITableView</code> 还是 <code>UICollectionView</code> 或者直接 <code>UIScrollView</code> 实现起来更方便更合理，把里面能够重用的部分和看起来较完整的部分抽出一个 View 进行实现。当这些 View 的模块都构成好之后，我们可以拿到 ViewController 中去拼装一下，这样完整的界面就出来了，很像是搭积木。</p>
<p>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">- (void)initUI &#123;</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    </span><br><span class="line">    topView = [[TopCategoryView alloc]initWithFrame:CGRectMake(0, 0, SCREEN_WIDTH-80, 44)];</span><br><span class="line">    topView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    _scrollView = (&#123;</span><br><span class="line">        UIScrollView *view = [UIScrollView new];</span><br><span class="line">        view.pagingEnabled = YES;</span><br><span class="line">        view.delegate = self;</span><br><span class="line">        [self.view addSubview:view];</span><br><span class="line">        </span><br><span class="line">        [view mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.edges.equalTo(self.view);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        view;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSNumber *pageWidth = [NSNumber numberWithFloat:CGRectGetWidth(self.view.frame)];</span><br><span class="line">    </span><br><span class="line">    _topHotPageView = (&#123;</span><br><span class="line">        TopHotPageView *view = [TopHotPageView new];</span><br><span class="line">        [view bindViewModel:self.viewModel];</span><br><span class="line">        [_scrollView addSubview:view];</span><br><span class="line">        </span><br><span class="line">        [view mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.top.bottom.equalTo(self.view).offset(64);</span><br><span class="line">            make.left.equalTo(_scrollView);</span><br><span class="line">            make.width.equalTo(pageWidth);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        view;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    _topCategoryPageView = (&#123;</span><br><span class="line">        TopCategoryPageView *view = [TopCategoryPageView new];</span><br><span class="line">        [view bindViewModel:self.viewModel];</span><br><span class="line">        [_scrollView addSubview:view];</span><br><span class="line">        </span><br><span class="line">        [view mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.left.equalTo(_topHotPageView.mas_right);</span><br><span class="line">            make.top.bottom.width.equalTo(_topHotPageView);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        view;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    _topBrandPageView = (&#123;</span><br><span class="line">        TopBrandPageView *view = [TopBrandPageView new];</span><br><span class="line">        [view bindViewModel:self.viewModel];</span><br><span class="line">        [_scrollView addSubview:view];</span><br><span class="line">        </span><br><span class="line">        [view mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.left.equalTo(_topCategoryPageView.mas_right);</span><br><span class="line">            make.top.bottom.width.equalTo(_topHotPageView);</span><br><span class="line">            make.right.equalTo(_scrollView);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        view;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ViewModel"><a href="#ViewModel" class="headerlink" title="ViewModel"></a>ViewModel</h3><p>ViewModel 并不是完全的承接在 <strong>MVC</strong> 中 ViewController 的工作，比如将所有页面相关的业务逻辑放到 ViewModel 中，这样 ViewModel 迟早会变得臃肿，不容易维护。它更像是调度室，将 View 中的事件，业务，功能和 ViewModel 绑定起来，当然这其中需要 RAC 的帮助，因为在 ViewModel 中绝不能引用到 View。在我的脑子中就想象 View 上有很多插孔，它们代表很多事件，RAC 就像一根根的线插到这些孔里，另一头插在 ViewModel 上。界面上需要做哪些工作，都会反应到 ViewModel 上，ViewModel 会引用一个实现了一个 service （定义的协议）的 imp 类。具体的工作就在这个 imp 类里，它处理完结果之后返回给 ViewModel ，ViewModel 再把结果通过这些 ‘线’ 传回到 View 中。这样大家角色清晰，分工明确，谁做了哪些工作一目了然。<br>ViewModel 里也可引用小 ViewModel，它们不做具体的调度处理，只做一些绑定工作，主要对接像 cell 或者其他 View 的事件。这样能让结构更清楚一些。</p>
<p>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">@interface CategoryPageViewModel : HCBaseViewModel</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readonly) RACCommand *layoutRequestCommand;</span><br><span class="line">@property (nonatomic, strong, readonly) RACCommand *categorysRequestCommand;</span><br><span class="line">@property (nonatomic, strong, readonly) RACCommand *brandsRequestCommand;</span><br><span class="line">@property (nonatomic, strong, readonly) RACCommand *pushCommand;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readonly) HCCategoryLayout *hotLayout;</span><br><span class="line">@property (nonatomic, strong, readonly) NSArray *cateList;</span><br><span class="line">@property (nonatomic, strong, readonly) NSMutableArray *brandList;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readonly) NSArray *topTitlesList;</span><br><span class="line">@property (nonatomic, assign) NSInteger brandsPageIndex;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, assign) BOOL refreshHotFlag;</span><br><span class="line">@property (nonatomic, assign) BOOL refreshCategoryFlag;</span><br><span class="line">@property (nonatomic, assign) BOOL refreshBrandFlag;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line">@interface CategoryPageViewModel ()</span><br><span class="line"></span><br><span class="line">@property (strong, nonatomic, readonly) id &lt;HCCategoryViewModelServices&gt; services;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) RACCommand *layoutRequestCommand;</span><br><span class="line">@property (nonatomic, strong, readwrite) RACCommand *categorysRequestCommand;</span><br><span class="line">@property (nonatomic, strong, readwrite) RACCommand *brandsRequestCommand;</span><br><span class="line">@property (nonatomic, strong, readwrite) RACCommand *pushCommand;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) HCCategoryLayout *hotLayout;</span><br><span class="line">@property (nonatomic, strong, readwrite) NSArray *cateList;</span><br><span class="line">@property (nonatomic, strong, readwrite) NSMutableArray *brandList;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) NSArray *topTitlesList;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation CategoryPageViewModel</span><br><span class="line">@dynamic services;</span><br><span class="line"></span><br><span class="line">- (void)initialize &#123;</span><br><span class="line">    </span><br><span class="line">    _cateList = [NSArray array];</span><br><span class="line">    _brandList = [NSMutableArray array];</span><br><span class="line">    _topTitlesList = @[@&quot;热门&quot;,@&quot;品类&quot;,@&quot;品牌&quot;];</span><br><span class="line">    _brandsPageIndex = 0;</span><br><span class="line">    _refreshHotFlag = YES;</span><br><span class="line">    _refreshCategoryFlag = YES;</span><br><span class="line">    _refreshBrandFlag = YES;</span><br><span class="line">    </span><br><span class="line">    self.layoutRequestCommand = [[RACCommand alloc]initWithSignalBlock:^RACSignal *(id input) &#123;</span><br><span class="line">        return [self executeHotSignal];</span><br><span class="line">    &#125;];</span><br><span class="line">    self.categorysRequestCommand = [[RACCommand alloc]initWithSignalBlock:^RACSignal *(id input) &#123;</span><br><span class="line">        return [self executeCateSignal];</span><br><span class="line">    &#125;];</span><br><span class="line">    self.brandsRequestCommand = [[RACCommand alloc]initWithSignalBlock:^RACSignal *(id input) &#123;</span><br><span class="line">        return [self executeBrandSignal:(NSInteger)input];</span><br><span class="line">    &#125;];</span><br><span class="line">    self.pushCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) &#123;</span><br><span class="line">        return [self executePushSignal:input];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (RACSignal *)executeHotSignal &#123;</span><br><span class="line">    @weakify(self);</span><br><span class="line">    return [[[self.services getCategoryApiService] getHotTapData] map:^id(id value) &#123;</span><br><span class="line">        @strongify(self);</span><br><span class="line">        self.hotLayout = [HCCategoryLayout modelWithJSON:value[@&quot;data&quot;]];</span><br><span class="line">        return self.hotLayout;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (RACSignal *)executeCateSignal &#123;</span><br><span class="line">    return [[[self.services getCategoryApiService] getCateTapData] map:^id(id value) &#123;</span><br><span class="line">        self.cateList = [NSArray modelArrayWithClass:HCCategory.class json:value[@&quot;data&quot;]];</span><br><span class="line">        return self.cateList;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (RACSignal *)executeBrandSignal:(NSInteger)pageIndex &#123;</span><br><span class="line">    return [[[self.services getCategoryApiService] getBrandDataWithIndexPage:_brandsPageIndex] map:^id(id value) &#123;</span><br><span class="line">        NSArray *data = [NSArray modelArrayWithClass:HCBrand.class json:value[@&quot;data&quot;]];</span><br><span class="line">        NSMutableArray *mutableData = [NSMutableArray arrayWithArray:_brandList];</span><br><span class="line">        [mutableData addObjectsFromArray:data];</span><br><span class="line">        self.brandList = mutableData;</span><br><span class="line">        return self.brandList;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (RACSignal *)executePushSignal:(id)viewModel &#123;</span><br><span class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        [self.services pushViewModel:viewModel animated:YES];</span><br><span class="line">        [subscriber sendCompleted];</span><br><span class="line">        return nil;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h3 id="Service，IMP-和-Model"><a href="#Service，IMP-和-Model" class="headerlink" title="Service，IMP 和 Model"></a>Service，IMP 和 Model</h3><p>Service 是一个协议，它定义整个界面需要的行为，比如，点击一个按钮，跳转到详情页面，这个跳转的逻辑要在 Service 中定义好。进入页面发起一些网络请求获取数据，这些 api 的调用可以放到协议中定义好。一个界面做了哪些工作，看一眼 Service 就一目了然了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//基础服务</span><br><span class="line">@protocol HCBaseService &lt;NSObject, HCNavigationService&gt;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line">@protocol HCCategoryViewModelServices &lt;HCBaseService&gt;</span><br><span class="line"></span><br><span class="line">//主服务</span><br><span class="line">- (id&lt;HCCategoryApiServices&gt;)getCategoryApiService;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">//子服务 api</span><br><span class="line">@protocol HCCategoryApiServices &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">- (RACSignal *)getHotTapData;</span><br><span class="line">- (RACSignal *)getCateTapData;</span><br><span class="line">- (RACSignal *)getBrandDataWithIndexPage:(NSInteger)indexPage;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>目前 <code>HCCategoryViewModelServices</code> 主服务里没有其他相关的业务逻辑，所以就只引用了 api 服务。<br>IMP，就是对这些服务的具体实现，供 ViewModel 调用。</p>
<p>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@interface HCCategoryViewModelServicesImp ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) HCCategoryApiServicesImpl *cateServiceImpl;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation HCCategoryViewModelServicesImp</span><br><span class="line"></span><br><span class="line">- (instancetype)init</span><br><span class="line">&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        _cateServiceImpl = [HCCategoryApiServicesImpl new];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (id&lt;HCCategoryApiServices&gt;)getCategoryApiService &#123;</span><br><span class="line">    return self.cateServiceImpl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)pushViewModel:(__nullable id)viewModel animated:(BOOL)animated &#123;</span><br><span class="line">    [super pushViewModel:viewModel animated:animated];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>Model，包括网络接口的数据模型和 api 的模型。</p>
<p>示意图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/292794-6639a17836b0b5e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="mvvm &amp; rac"></p>
<h2 id="仿写流程-和-注意事项"><a href="#仿写流程-和-注意事项" class="headerlink" title="仿写流程 和 注意事项"></a>仿写流程 和 注意事项</h2><p>首先，获取这个程序的 api 接口，从启动开始，到要实现的每个界面，最好按照一定的业务流程。如：商品列表到商品详情，再到购买页。<br>工具可以使用，<strong>Charles</strong> 。设置好手机无线网的代理，打开 app 就可以抓到接口了。抓到接口之后再使用 <strong>Postman</strong> ，记录下来，方便查看参数和返回的数据。<br>我们有了接口之后就可以通过它返回的数据，分析怎么更好的布局页面。我刚开始的时候，不是这么做的，而是先截图界面，去构建 UI，待后来开始分析接口的时候，才发现，它的首页都是根据接口返回的数据，动态生成的，而不是我理解的固定的界面模版。比如：它的限时抢购有时有有时没有，它的几个广告栏的个数也是不确定的，等等。<br>只有这些接口的结构确定了，界面，业务逻辑等才能无缝的嵌进去。</p>
<p>获取程序的 ipa 安装包，在安装包里获取所需要的图片资源。<br>构建 UI 还可以使用工具 <strong>Reveal</strong> ，能帮助我们查看仿写 app 的界面结构，这主要是在我们对某个界面的写法上没有头绪或者想看下别人的实现方法上很有帮助。</p>
<p>尽量把工作拆分出来，定个完成时间，能帮助自己提高些效率。使用 Git 管理自己的项目。</p>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>希望大家能多提宝贵意见，我会不断完善。</p>

  </div>
</article>



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <div id="gitalk-container"></div>
    <script type="text/javascript">
        import md5 from "md5";
        var id = md5(window.location.pathname);
        var gitalk = new Gitalk({
            clientID: '46f9862d762f2b91e265',
            clientSecret: 'b1a5c3d47828b1c1ab0b25081463e2b94f132245',
            id: id,
            repo: 'al-liu.github.io',
            owner: 'al-liu',
            admin: 'al-liu',
            distractionFreeMode: ''
        })
        gitalk.render('gitalk-container')
    </script>




        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="https://github.com/al-liu">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://github.com/al-liu?tab=repositories">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么仿写-app"><span class="toc-number">1.</span> <span class="toc-text">为什么仿写 app</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么是有范儿"><span class="toc-number">2.</span> <span class="toc-text">为什么是有范儿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仿写目的"><span class="toc-number">3.</span> <span class="toc-text">仿写目的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#View"><span class="toc-number">3.1.</span> <span class="toc-text">View</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ViewModel"><span class="toc-number">3.2.</span> <span class="toc-text">ViewModel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Service，IMP-和-Model"><span class="toc-number">3.3.</span> <span class="toc-text">Service，IMP 和 Model</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仿写流程-和-注意事项"><span class="toc-number">4.</span> <span class="toc-text">仿写流程 和 注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">5.</span> <span class="toc-text">最后</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://github.com/al-liu/2019/04/02/仿写有范儿-app/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&text=仿写有范儿 app"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&is_video=false&description=仿写有范儿 app"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=仿写有范儿 app&body=Check out this article: https://github.com/al-liu/2019/04/02/仿写有范儿-app/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&title=仿写有范儿 app"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://github.com/al-liu/2019/04/02/仿写有范儿-app/&name=仿写有范儿 app&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 刘海川 al-liu
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="https://github.com/al-liu">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://github.com/al-liu?tab=repositories">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
